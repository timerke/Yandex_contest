Площадь между кривыми

Заданы 2 функции f, g. Каждую из этих функций представим в виде n и m частей, каждая из которых представима
в виде многочлена второй степени. Нужно посчитать площадь между этими функциями. Более формально нужно посчитать 
∫∣∣f(x)−g(x)∣∣dx, где l0 и ln – границы области определения.

Формат ввода
В первой строке заданы 2 целых числа n и m (1≤n,m≤10^5), каждое из которых задает количество частей, из которых
состоят функции f и g соответственно. В следующей строке n+1 целое число li (−10^9≤l0<⋯<li−1<li<li+1<⋯<ln≤10^9),
задающие граничные точки каждой части функции f. Далее идут n строк, в каждой из которых 3 целых числа: a, b и
c, которые задают многочлен второй степени ax^2+bx+c. (−10^9≤a,b,c≤10^9). В следующей строке m+1 целое число 
ri (−10^9≤r0<⋯<ri−1<ri<ri+1<⋯<rm≤10^9), задающие граничные точки каждой части функции g. Далее идут m строк,
в каждой из которых 3 целых числа: a, b и c, которые задают многочлен второй степени ax^2+bx+c. (−10^9≤a,b,c≤
10^9). Гарантируется, что l0=r0 и ln=rm.

Формат вывода
Выведите площадь между заданными функциями c абсолютной или относительной точностью 
10^−6.

Пример 1
Ввод
1 1
0 1
0 0 1
0 1
0 0 2

Вывод
1.0000000000

Пример 2
Ввод
1 1
0 1
1 -2 1
0 1
-1 2 1

Вывод
1.3333333333

Примечания
В терминах данной задачи у многочленов второй степени может стоят нулевой коэффициент при любой степени.